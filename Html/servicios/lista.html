<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <title>Servicios - Lista</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" th:href="@{/css/admin.css}">
</head>

<body class="bg-light">

<div class="container mt-4">

    <h1 class="mb-4 text-center">Lista de Servicios</h1>

    <!-- FORMULARIO DE FILTRO MULTICRITERIO -->
    <form class="row g-2 mb-4" method="get" action="/admin/servicios/lista">

        <div class="col-md-2">
            <input type="number" class="form-control" name="id" placeholder="ID"
                   th:value="${filtroId}">
        </div>

        <div class="col-md-3">
            <input type="text" class="form-control" name="nombre" placeholder="Nombre"
                   th:value="${filtroNombre}">
        </div>

        <div class="col-md-3">
            <select class="form-control" name="idCategoria">
                <option value="">Todas las categor√≠as</option>
                <option th:each="cat : ${categorias}" th:value="${cat.idCategoria}"
                        th:text="${cat.nombre}" th:selected="${cat.idCategoria} == ${filtroIdCategoria}">
                </option>
            </select>
        </div>

        <div class="col-md-2">
            <button type="submit" class="btn btn-success w-100">Filtrar</button>
        </div>

        <div class="col-md-2">
            <a class="btn btn-secondary w-100" th:href="@{/admin/servicios/lista}">Limpiar</a>
        </div>

    </form>

    <div class="text-end mb-3">
        <a class="btn btn-primary" th:href="@{/admin/servicios/crear}">+ Crear Servicio</a>

        <!-- BOT√ìN EXPORTAR PDF -->
        <a class="btn btn-danger"
           th:href="@{/admin/servicios/exportar-pdf(
                id=${filtroId != null} ? ${filtroId} : '',
                nombre=${filtroNombre != null} ? ${filtroNombre} : '',
                idCategoria=${filtroIdCategoria != null} ? ${filtroIdCategoria} : ''
           )}">
            üìÑ Exportar PDF
        </a>
    </div>

    <table class="table table-striped table-hover">
        <thead>
            <tr>
                <th>ID</th>
                <th>Nombre</th>
                <th>Categoria</th>
                <th>Precio</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody>
            <tr th:each="s : ${servicios}">
                <td th:text="${s.idServicio}"></td>
                <td th:text="${s.nombre}"></td>
                <td th:text="${s.categoria != null ? s.categoria.nombre : 'Sin categor√≠a'}"></td>
                <td th:text="${s.precio}"></td>
                <td>
                    <a th:href="@{/admin/servicios/editar/{id}(id=${s.idServicio})}" class="btn btn-warning btn-sm">Editar</a>
                    <a th:href="@{/admin/servicios/eliminar/{id}(id=${s.idServicio})}" onclick="return confirm('¬øEliminar?')" class="btn btn-danger btn-sm">Eliminar</a>
                </td>
            </tr>
        </tbody>
    </table>
    <div class="mt-4">
        <a class="btn btn-secondary" th:href="@{/admin/dashboard}">‚Üê Volver al panel</a>
    </div>

</div>

</body>
</html>
